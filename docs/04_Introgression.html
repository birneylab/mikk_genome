<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2021-10-20" />

<title>Introgression</title>

<script src="site_libs/header-attrs-2.9/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MIKK panel genome</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="01_Fecundity.html">Fecundity</a>
</li>
<li>
  <a href="02_LD_decay.html">Linkage Disequilibrium</a>
</li>
<li>
  <a href="03_Nucleotide_diversity.html">Nucleotide diversity</a>
</li>
<li>
  <a href="04_Introgression.html">Introgression</a>
</li>
<li>
  <a href="05_Repeats.html">Repeat Elements</a>
</li>
<li>
  <a href="06_Structural_variation.html">Structural variation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Introgression</h1>
<h4 class="date">2021-10-20</h4>

</div>


<p>We want to determine the extent to which the MIKK panel shows evidence of introgression with other medaka populations, specifically the allopatric Northern and Korean medaka strains, relative to sympatric Southern medaka strains.</p>
<div id="setup" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Setup</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;code&quot;</span>, <span class="st">&quot;scripts&quot;</span>, <span class="st">&quot;introgression&quot;</span>, <span class="st">&quot;source.R&quot;</span>))</span></code></pre></div>
<div id="working-directory" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Working directory</h2>
<p>Working directory on EBI cluster: <code>/hps/research1/birney/users/ian/mikk_paper</code></p>
</div>
<div id="create-singularity-containers" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Create Singularity containers</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">container_dir=</span>../sing_conts</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load Singularity (version 3.5.0)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load singularity </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> package <span class="kw">in</span> <span class="va">$(</span> <span class="bu">echo</span> r-base_4.0.4 bcftools_1.9 numpy_1.15.4 bash_3.0.22 bioconductor_3.12 <span class="va">)</span> <span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">[[</span> <span class="ot">!</span> <span class="ot">-f</span> <span class="va">$container_dir</span>/<span class="va">$package</span>.sif <span class="kw">]];</span> <span class="cf">then</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">singularity</span> build <span class="dt">\</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">--remote</span> <span class="dt">\</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="va">$container_dir</span>/<span class="va">$package</span>.sif <span class="dt">\</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      envs/<span class="va">$package</span>.def </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">fi</span> <span class="kw">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
</div>
<div id="renv" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> <code>renv</code></h2>
<p>Install all required packages (using r-base in Singularity container).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">container_dir=</span>../sing_conts</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="va">baseR=</span>r-base_4.0.4</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ex">bsub</span> <span class="at">-Is</span> <span class="st">&quot;singularity shell </span><span class="va">$container_dir</span><span class="st">/</span><span class="va">$baseR</span><span class="st">&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install all required packages</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">restore</span>()</span></code></pre></div>
</div>
<div id="copy-scripts-from-simon-martins-github-repo" class="section level2" number="1.4">
<h2 number="1.4"><span class="header-section-number">1.4</span> Copy scripts from Simon Martin’s GitHub repo</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-P</span> code/scripts/introgression https://raw.githubusercontent.com/simonhmartin/genomics_general/master/ABBABABAwindows.py</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-P</span> code/scripts/introgression https://raw.githubusercontent.com/simonhmartin/genomics_general/master/genomics.py</span></code></pre></div>
</div>
</div>
<div id="process-multiple-alignment-data" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Process multiple alignment data</h1>
<div id="download-from-ensembl" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Download from Ensembl</h2>
<ul>
<li><span style="color: purple;">Ensembl 103</span>: Only includes Oryzias latipes HdrR and Oryzias melastigma (Indian medaka).</li>
<li><span style="color: &quot;purple;">Ensembl 102</span>: Includes all target species. Use.</li>
</ul>
<p><code>ftp://ftp.ensembl.org/pub/release-102/emf/ensembl-compara/multiple_alignments/50_fish.epo/README.50_fish.epo</code> reads:</p>
<blockquote>
<p>Alignments are grouped by japanese medaka hdrr chromosome, and then by coordinate system. Alignments containing duplications in japanese medaka hdrr are dumped once per duplicated segment. The files named <em>.other</em>.emf contain alignments that do not include any japanese medaka hdrr region. Each file contains up to 200 alignments.</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">ftp_dir=</span>ftp://ftp.ensembl.org/pub/release-102/emf/ensembl-compara/multiple_alignments/50_fish.epo/</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="va">target_dir=</span>../introgression/release-102</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$target_dir</span>/raw</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># download, exlcuding *.other* files</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-P</span> <span class="va">$target_dir</span>/raw <span class="va">$ftp_dir</span>/<span class="pp">*</span> <span class="at">-R</span> <span class="st">&quot;*other*&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># unzip into new directory (excluding &quot;other&quot;)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="va">$target_dir</span><span class="ex">/unzipped</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$target_dir</span>/unzipped</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> <span class="va">$target_dir</span>/raw/50_fish.epo.[0-9]<span class="pp">*</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="va">name=$(</span><span class="fu">basename</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-f3,4</span> <span class="at">-d</span><span class="st">&#39;.&#39;</span><span class="va">)</span><span class="kw">;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="ex">bsub</span> <span class="st">&quot;zcat </span><span class="va">$i</span><span class="st"> &gt; </span><span class="va">$target_dir</span><span class="st">/unzipped/</span><span class="va">$name</span><span class="st">&quot;</span><span class="kw">;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span></code></pre></div>
<ul>
<li><span style="color: red;"><strong>NOTE</strong></span>: File 6_2.emf is in a completely different format, with CIGAR strings instead of the normal SEQ, TREE, ID and DATA segments. It appears the file is corrupted.</li>
<li>The 6_2 file in <code>release 101</code> is unaffected. Remove all <code>release 102</code> chr 6 files and replace with <code>release 101</code> files.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove release 102 files for chr 6</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="va">$target_dir</span>/unzipped/6_<span class="pp">*</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># download chr 6 files from release 101</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="va">ftp_dir_101=</span>ftp://ftp.ensembl.org/pub/release-101/emf/ensembl-compara/multiple_alignments/50_fish.epo/</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="va">target_dir_101=</span>../introgression/release-101</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$target_dir_101</span>/raw</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> <span class="at">-P</span> <span class="va">$target_dir_101</span>/raw <span class="va">$ftp_dir_101</span>/50_fish.epo.6_<span class="pp">*</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># unzip</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$target_dir_101</span>/unzipped</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> <span class="va">$target_dir_101</span>/raw/<span class="pp">*</span><span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="va">name=$(</span><span class="fu">basename</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-f3,4</span> <span class="at">-d</span><span class="st">&#39;.&#39;</span><span class="va">)</span> <span class="kw">;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">zcat</span> <span class="va">$i</span> <span class="op">&gt;</span> <span class="va">$target_dir_101</span>/unzipped/<span class="va">$name</span> <span class="kw">;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># copy over to release 102 directory</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> <span class="va">$target_dir_101</span>/unzipped/<span class="pp">*</span> <span class="va">$target_dir</span>/unzipped</span></code></pre></div>
</div>
<div id="generate-tree-plot" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Generate tree plot</h2>
<p>Copy tree to file</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">tree_file=</span>data/introgression/release_102_tree.txt</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">awk</span> <span class="st">&quot;NR==58,NR==205&quot;</span> <span class="va">$target_dir</span>/raw/README.50_fish.epo <span class="dt">\</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">&gt;</span> <span class="va">$tree_file</span></span></code></pre></div>
<p>Then manually edit <code>$tree_file</code> using regex to find spaces and replace them with "_": <code>{bash} (?&lt;=[a-z])( )(?=[a-z])</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>phylo_tree <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;introgression&quot;</span>, <span class="st">&quot;release_102_tree.txt&quot;</span>))</span></code></pre></div>
<div id="full-tree" class="section level3" number="2.2.1">
<h3 number="2.2.1"><span class="header-section-number">2.2.1</span> Full tree</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colour all Oryzias</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> phylo_tree<span class="sc">$</span>tip.label[<span class="fu">grep</span>(<span class="st">&quot;Oryzias_latipes&quot;</span>, phylo_tree<span class="sc">$</span>tip.label)]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get indices of edges descending from MRCA (determined through trial and error)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>oryzias_nodes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">39</span>, <span class="dv">42</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>all_med_col <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(phylo_tree[[<span class="st">&quot;edge.length&quot;</span>]]) <span class="sc">%in%</span> oryzias_nodes, <span class="st">&quot;#E84141&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set colours for tip labels</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>all_med_tip <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(phylo_tree<span class="sc">$</span>tip.label <span class="sc">%in%</span> ids, <span class="st">&quot;#E84141&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">use.edge.length =</span> T,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">edge.color =</span> all_med_col,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> all_med_tip,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-10-1.svg" width="1056" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save to repo</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span> <span class="fu">file.path</span>(plots_dir, <span class="st">&quot;tree_all_olat_highlight.png&quot;</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">22</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">25</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">use.edge.length =</span> T,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">edge.color =</span> all_med_col,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> all_med_tip,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="oryzias-only" class="section level3" number="2.2.2">
<h3 number="2.2.2"><span class="header-section-number">2.2.2</span> Oryzias only</h3>
<p>New tree file created manually to extract <em>Oryzias</em> fishes only, and replace reference codes (e.g. “ASM223467v1”) with line names (e.g. “HdrR”).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/introgression/release_102_tree_oryzias_only.txt&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>phylo_tree <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">file =</span> in_file)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colours </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>phylo_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#55b6b0&quot;</span>, <span class="st">&quot;#f33a56&quot;</span>, <span class="st">&quot;#f3b61f&quot;</span>, <span class="st">&quot;#f6673a&quot;</span>, <span class="st">&quot;#631e68&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> phylo_cols)</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-12-1.svg" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias.png&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>out_file,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">2700</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">1720</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> phylo_cols)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div id="add-cross-for-ancestor" class="section level4" number="2.2.2.1">
<h4 number="2.2.2.1"><span class="header-section-number">2.2.2.1</span> Add cross for ancestor</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_with_ancestor.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias.png&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>tree_path <span class="ot">=</span> in_file</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(tree_path) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="fl">0.152</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fl">0.52</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">25</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(out_file,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="fl">15.69</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">10</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">dpi =</span> <span class="dv">400</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_file)</span></code></pre></div>
<p><img src="plots/introgression/tree_oryzias_with_ancestor.png" width="1235" /> ### Oryzias latipes only</p>
<p>New tree file created manually to extract <em>Oryzias latipes</em> fishes only, and replace reference codes (e.g. “ASM223467v1”) with line names (e.g. “HdrR”).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/introgression/release_102_tree_oryzias_latipes_only.txt&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>phylo_tree <span class="ot">&lt;-</span> ape<span class="sc">::</span><span class="fu">read.tree</span>(<span class="at">file =</span> in_file)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colours </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>phylo_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#9E2B25&quot;</span>, <span class="st">&quot;#f6673a&quot;</span>, <span class="st">&quot;#631e68&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> phylo_cols)</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-17-1.svg" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_latipes.png&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Save</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>out_file,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">2700</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">1720</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>ape<span class="sc">::</span><span class="fu">plot.phylo</span>(phylo_tree,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">font =</span> <span class="dv">4</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">tip.color =</span> phylo_cols)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="add-cross-for-ancestor-1" class="section level4" number="2.2.2.2">
<h4 number="2.2.2.2"><span class="header-section-number">2.2.2.2</span> Add cross for ancestor</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_latipes_with_ancestor.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_latipes.png&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>tree_path <span class="ot">=</span> in_file</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(tree_path) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="fl">0.152</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fl">0.52</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">25</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(out_file,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="fl">15.69</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">10</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">dpi =</span> <span class="dv">400</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_file)</span></code></pre></div>
<p><img src="plots/introgression/tree_oryzias_latipes_with_ancestor.png" width="1235" /></p>
</div>
</div>
</div>
<div id="divide-by-segment" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Divide by segment</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="va">target_dir=</span>../introgression/release-102</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="va">segments_dir=$target_dir</span>/segmented</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="va">date=</span>20210312</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="va">script=</span>code/scripts/introgression/20200907_extract-emf-segments.sh</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$segments_dir</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="va">$(</span><span class="fu">find</span> <span class="va">$target_dir</span>/unzipped/<span class="pp">*</span> <span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get basename</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="va">bname=$(</span><span class="fu">basename</span> <span class="va">$i)</span><span class="kw">;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="va">bname_short=$(</span><span class="bu">echo</span> <span class="va">${bname</span><span class="op">::</span>-<span class="dv">4</span><span class="va">}</span> <span class="va">)</span><span class="kw">;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get chromosome</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">chr=$(</span><span class="bu">echo</span> <span class="va">$bname</span> <span class="kw">|</span> <span class="fu">cut</span> <span class="at">-f1</span> <span class="at">-d</span><span class="st">&quot;_&quot;</span> <span class="va">)</span><span class="kw">;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make directory for each EMF file</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="va">new_path=$(</span><span class="bu">echo</span> <span class="va">$segments_dir</span>/<span class="va">$bname_short</span> <span class="va">)</span><span class="kw">;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-d</span> <span class="st">&quot;</span><span class="va">$new_path</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mkdir</span> <span class="va">$new_path</span><span class="kw">;</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">fi</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get segment count</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">segment_count=$(</span><span class="fu">grep</span> <span class="st">&quot;^DATA&quot;</span> <span class="va">$i</span> <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span> <span class="va">)</span><span class="kw">;</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get segment start and end for each file</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="va">$(</span><span class="fu">seq</span> 1 <span class="va">$segment_count</span> <span class="va">)</span><span class="kw">;</span> <span class="cf">do</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="ex">bsub</span> <span class="dt">\</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">-o</span> ../log/<span class="va">$date</span><span class="dt">\s</span>egment_<span class="va">$bname_short</span><span class="dt">\_</span><span class="va">$j</span>.out <span class="dt">\</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">-e</span> ../log/<span class="va">$date</span><span class="dt">\s</span>egment_<span class="va">$bname_short</span><span class="dt">\_</span><span class="va">$j</span>.err <span class="dt">\</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;</span><span class="va">$script</span><span class="st"> </span><span class="va">$i</span><span class="st"> </span><span class="va">$j</span><span class="st"> </span><span class="va">$new_path</span><span class="st"> &quot;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">done</span><span class="kw">;</span>  </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># How many files?</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> <span class="va">$segments_dir</span>/<span class="pp">*</span>/<span class="pp">*</span>.data.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 8951</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> <span class="va">$in_dir</span>/<span class="pp">*</span>/<span class="pp">*</span>_1.data.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 4341</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> <span class="va">$in_dir</span>/<span class="pp">*</span>/<span class="pp">*</span>_-1.data.txt <span class="kw">|</span> <span class="fu">wc</span> <span class="at">-l</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4610</span></span></code></pre></div>
</div>
<div id="run-analysis-pipeline-with-snakemake" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> Run analysis pipeline with <code>snakemake</code></h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="va">snmk_proj=</span><span class="st">&quot;introgression&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="ex">module</span> load singularity</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate snakemake</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="ex">snakemake</span> <span class="dt">\</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> <span class="at">--jobs</span> 5000 <span class="dt">\</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> <span class="at">--latency-wait</span> 100 <span class="dt">\</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a> <span class="at">--cluster-config</span> code/snakemake/<span class="va">$snmk_proj</span>/config/cluster.json <span class="dt">\</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a> <span class="at">--cluster</span> <span class="st">&#39;bsub -g /snakemake_bgenie -J {cluster.name} -n {cluster.n} -M {cluster.memory} -o {cluster.output} -e {cluster.error}&#39;</span> <span class="dt">\</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a> <span class="at">--keep-going</span> <span class="dt">\</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a> <span class="at">--rerun-incomplete</span> <span class="dt">\</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a> <span class="at">--use-conda</span> <span class="dt">\</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a> <span class="at">--use-singularity</span> <span class="dt">\</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a> <span class="at">-s</span> code/snakemake/<span class="va">$snmk_proj</span>/Snakefile <span class="dt">\</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a> <span class="at">-p</span></span></code></pre></div>
</div>
</div>
<div id="f-statistic-analysis" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> <em>f</em> statistic analysis</h1>
<div id="read-in-data" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Read in data</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;introgression&quot;</span>, <span class="st">&quot;20210315_f_stat_final.txt&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>final_df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(data_file,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">header =</span> T,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">as.is =</span> T)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>final_df <span class="ot">&lt;-</span> final_df <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(P2,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span><span class="fu">factor</span>(.x, <span class="at">levels =</span> fish_order))) <span class="sc">%&gt;%</span> </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">chr =</span> <span class="fu">factor</span>(chr, <span class="at">levels =</span> chr_order))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(final_df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">P1</th>
<th align="left">P2</th>
<th align="left">P3</th>
<th align="left">chr</th>
<th align="right">d_stat</th>
<th align="right">z_score</th>
<th align="right">admix_f</th>
<th align="right">f_ci_lower</th>
<th align="right">f_ci_upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">all</td>
<td align="right">0.9072306</td>
<td align="right">324.06735</td>
<td align="right">0.7093524</td>
<td align="right">0.6943606</td>
<td align="right">0.7243441</td>
</tr>
<tr class="even">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">1</td>
<td align="right">0.9422313</td>
<td align="right">162.46960</td>
<td align="right">0.8090713</td>
<td align="right">0.7776743</td>
<td align="right">0.8404682</td>
</tr>
<tr class="odd">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">2</td>
<td align="right">0.9128441</td>
<td align="right">57.55129</td>
<td align="right">0.7668972</td>
<td align="right">0.6931469</td>
<td align="right">0.8406474</td>
</tr>
<tr class="even">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">3</td>
<td align="right">0.8869725</td>
<td align="right">76.53532</td>
<td align="right">0.6217246</td>
<td align="right">0.5501172</td>
<td align="right">0.6933320</td>
</tr>
<tr class="odd">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">4</td>
<td align="right">0.9318431</td>
<td align="right">72.86056</td>
<td align="right">0.7503846</td>
<td align="right">0.6643958</td>
<td align="right">0.8363734</td>
</tr>
<tr class="even">
<td align="left">javanicus</td>
<td align="left">HdrR</td>
<td align="left">MIKK</td>
<td align="left">5</td>
<td align="right">0.8879805</td>
<td align="right">69.67407</td>
<td align="right">0.6565419</td>
<td align="right">0.5865893</td>
<td align="right">0.7264945</td>
</tr>
</tbody>
</table>
</div>
<div id="create-df-with-mean-melastigma-and-javanicus" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Create DF with mean <code>melastigma</code> and <code>javanicus</code></h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>cor_df <span class="ot">&lt;-</span> final_df <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for when P1 is another Oryzias, and P2 </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(P1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;javanicus&quot;</span>, <span class="st">&quot;melastigma&quot;</span>) <span class="sc">&amp;</span> P2 <span class="sc">!=</span> <span class="st">&quot;MIKK&quot;</span> <span class="sc">&amp;</span> P3 <span class="sc">==</span> <span class="st">&quot;MIKK&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot to put the admixture_f stat for melastigma and javanicus in the same row</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">&quot;P2&quot;</span>, <span class="st">&quot;chr&quot;</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">names_from =</span> P1,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values_from =</span> <span class="fu">c</span>(admix_f, f_ci_lower, f_ci_upper))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>cor_df<span class="sc">$</span>chr <span class="ot">&lt;-</span> <span class="fu">as.character</span>(cor_df<span class="sc">$</span>chr)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>cor_df<span class="sc">$</span>chr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(cor_df<span class="sc">$</span>chr <span class="sc">==</span> <span class="st">&quot;all&quot;</span>, <span class="st">&quot;genome-wide&quot;</span>, cor_df<span class="sc">$</span>chr)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>chr_order_plot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">24</span>), <span class="st">&quot;genome-wide&quot;</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>cor_df<span class="sc">$</span>chr <span class="ot">&lt;-</span> <span class="fu">factor</span>(cor_df<span class="sc">$</span>chr, <span class="at">levels =</span> chr_order_plot)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>cor_df_means <span class="ot">&lt;-</span> cor_df <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># apply across rows</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get means for f and CIs</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mean_f =</span> <span class="fu">mean</span>(<span class="fu">c</span>(admix_f_javanicus, admix_f_melastigma)),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_ci_upper =</span> <span class="fu">mean</span>(<span class="fu">c</span>(f_ci_upper_javanicus, f_ci_upper_melastigma)),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_ci_lower =</span> <span class="fu">mean</span>(<span class="fu">c</span>(f_ci_lower_javanicus, f_ci_lower_melastigma))) <span class="sc">%&gt;%</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set stats at a maximum of 1</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;mean_f&quot;</span>, <span class="st">&quot;mean_ci_upper&quot;</span>, <span class="st">&quot;mean_ci_lower&quot;</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span>dplyr<span class="sc">::</span><span class="fu">if_else</span>(.x <span class="sc">&gt;</span> <span class="dv">1</span>,</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="dv">1</span>,</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                                       .x)))</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(cor_df_means))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="2%" />
<col width="6%" />
<col width="10%" />
<col width="10%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="5%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">P2</th>
<th align="left">chr</th>
<th align="right">admix_f_javanicus</th>
<th align="right">admix_f_melastigma</th>
<th align="right">f_ci_lower_javanicus</th>
<th align="right">f_ci_lower_melastigma</th>
<th align="right">f_ci_upper_javanicus</th>
<th align="right">f_ci_upper_melastigma</th>
<th align="right">mean_f</th>
<th align="right">mean_ci_upper</th>
<th align="right">mean_ci_lower</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">HdrR</td>
<td align="left">genome-wide</td>
<td align="right">0.7093524</td>
<td align="right">0.6860648</td>
<td align="right">0.6943606</td>
<td align="right">0.6712495</td>
<td align="right">0.7243441</td>
<td align="right">0.7008800</td>
<td align="right">0.6977086</td>
<td align="right">0.7126121</td>
<td align="right">0.6828051</td>
</tr>
<tr class="even">
<td align="left">HdrR</td>
<td align="left">1</td>
<td align="right">0.8090713</td>
<td align="right">0.7831495</td>
<td align="right">0.7776743</td>
<td align="right">0.7466954</td>
<td align="right">0.8404682</td>
<td align="right">0.8196036</td>
<td align="right">0.7961104</td>
<td align="right">0.8300359</td>
<td align="right">0.7621849</td>
</tr>
<tr class="odd">
<td align="left">HdrR</td>
<td align="left">2</td>
<td align="right">0.7668972</td>
<td align="right">0.7621796</td>
<td align="right">0.6931469</td>
<td align="right">0.6999464</td>
<td align="right">0.8406474</td>
<td align="right">0.8244128</td>
<td align="right">0.7645384</td>
<td align="right">0.8325301</td>
<td align="right">0.6965466</td>
</tr>
<tr class="even">
<td align="left">HdrR</td>
<td align="left">3</td>
<td align="right">0.6217246</td>
<td align="right">0.5968322</td>
<td align="right">0.5501172</td>
<td align="right">0.5217981</td>
<td align="right">0.6933320</td>
<td align="right">0.6718664</td>
<td align="right">0.6092784</td>
<td align="right">0.6825992</td>
<td align="right">0.5359576</td>
</tr>
<tr class="odd">
<td align="left">HdrR</td>
<td align="left">4</td>
<td align="right">0.7503846</td>
<td align="right">0.7399951</td>
<td align="right">0.6643958</td>
<td align="right">0.6811117</td>
<td align="right">0.8363734</td>
<td align="right">0.7988785</td>
<td align="right">0.7451899</td>
<td align="right">0.8176260</td>
<td align="right">0.6727538</td>
</tr>
<tr class="even">
<td align="left">HdrR</td>
<td align="left">5</td>
<td align="right">0.6565419</td>
<td align="right">0.6241430</td>
<td align="right">0.5865893</td>
<td align="right">0.5565435</td>
<td align="right">0.7264945</td>
<td align="right">0.6917426</td>
<td align="right">0.6403425</td>
<td align="right">0.7091186</td>
<td align="right">0.5715664</td>
</tr>
</tbody>
</table>
</div>
<div id="plot" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Plot</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fstat_plot <span class="ot">=</span> cor_df_means <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(P2, mean_f, <span class="at">fill =</span> P2)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_ci_lower,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> mean_ci_upper),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span>  </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> F) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>chr) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;f&quot;</span>), <span class="st">&quot; statistic&quot;</span>))) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>(<span class="at">font_size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_abba)</span></code></pre></div>
<pre><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## &quot;none&quot;)` instead.</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fstat_plot</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-26-1.svg" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210315_f_stat&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># PNG</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">paste</span>(out_file, <span class="st">&quot;.png&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">24.75</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">19.5</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">500</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># SVG</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">paste</span>(out_file, <span class="st">&quot;.svg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;svg&quot;</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">24.75</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">19.5</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="sliding-windows-abba-baba" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Sliding windows ABBA BABA</h1>
<div id="read-in-data-1" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Read in data</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;introgression&quot;</span>, <span class="st">&quot;abba_sliding_final&quot;</span>, <span class="st">&quot;50000_100.txt&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(in_file) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p1, p2, scaffold, start)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert fd to 0 if D &lt; 0</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fd <span class="ot">=</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>D <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>               df<span class="sc">$</span>fd)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change names</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p2 =</span> <span class="fu">recode</span>(df<span class="sc">$</span>p2, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))</span></code></pre></div>
</div>
<div id="plot-1" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Plot</h2>
<div id="standard" class="section level3" number="4.2.1">
<h3 number="4.2.1"><span class="header-section-number">4.2.1</span> Standard</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p1 <span class="sc">==</span> <span class="st">&quot;melastigma&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(mid, fd, <span class="at">colour =</span> p2)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>scaffold, <span class="at">nrow =</span> <span class="dv">24</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> pal_abba) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5000000</span>, <span class="dv">10000000</span>, <span class="dv">15000000</span>, <span class="dv">20000000</span>, <span class="dv">25000000</span>, <span class="dv">30000000</span>, <span class="dv">35000000</span>),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Base position&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">bquote</span>(<span class="fu">italic</span>(f[d]))) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&quot;P2&quot;</span>)</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-29-1.svg" width="960" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210317_abba_sliding.png&quot;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> out_file,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">24.75</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="dv">50</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="karyoplot" class="section level3" number="4.2.2">
<h3 number="4.2.2"><span class="header-section-number">4.2.2</span> Karyoplot</h3>
<div id="make-custom-chromosome-scaffold" class="section level4" number="4.2.2.1">
<h4 number="4.2.2.1"><span class="header-section-number">4.2.2.1</span> Make custom chromosome scaffold</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get chromosome lengths</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>med_chr_lens <span class="ot">=</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Oryzias_latipes.ASM223467v1.dna.toplevel.fa_chr_counts.txt&quot;</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;end&quot;</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add start</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>med_chr_lens<span class="sc">$</span>start <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>med_chr_lens <span class="ot">=</span> med_chr_lens <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(chr, start, end)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create custom genome</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>med_genome <span class="ot">=</span> regioneR<span class="sc">::</span><span class="fu">toGRanges</span>(med_chr_lens)</span></code></pre></div>
</div>
<div id="process-abba-sliding-windows-data" class="section level4" number="4.2.2.2">
<h4 number="4.2.2.2"><span class="header-section-number">4.2.2.2</span> Process ABBA sliding windows data</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;introgression&quot;</span>, <span class="st">&quot;abba_sliding_final&quot;</span>, <span class="st">&quot;50000_100.txt&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(in_file) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p1, p2, scaffold, start)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert fd to 0 if D &lt; 0</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fd <span class="ot">=</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>D <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>               df<span class="sc">$</span>fd)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change names</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p2 =</span> <span class="fu">recode</span>(df<span class="sc">$</span>p2, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get df with mean of melastigma/javanicus</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>df_kp <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(scaffold, start, end, mid, p2), <span class="at">names_from =</span> p1, <span class="at">values_from =</span> fd) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get mean of melastigma/javanicus</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mean_fd =</span> <span class="fu">rowMeans</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., melastigma, javanicus), <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p2, scaffold, start)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(df_kp))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">scaffold</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="right">mid</th>
<th align="left">p2</th>
<th align="right">javanicus</th>
<th align="right">melastigma</th>
<th align="right">mean_fd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">650001</td>
<td align="right">700000</td>
<td align="right">666130</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.1231</td>
<td align="right">0.12310</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">700001</td>
<td align="right">750000</td>
<td align="right">721651</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.2357</td>
<td align="right">0.23570</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">750001</td>
<td align="right">800000</td>
<td align="right">774678</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.1636</td>
<td align="right">0.16360</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">950001</td>
<td align="right">1000000</td>
<td align="right">974734</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.2203</td>
<td align="right">0.22030</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1000001</td>
<td align="right">1050000</td>
<td align="right">1028780</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.2935</td>
<td align="right">0.29350</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1050001</td>
<td align="right">1100000</td>
<td align="right">1075868</td>
<td align="left">HdrR</td>
<td align="right">0.4066</td>
<td align="right">0.2985</td>
<td align="right">0.35255</td>
</tr>
</tbody>
</table>
</div>
<div id="read-in-snp-density-data" class="section level4" number="4.2.2.3">
<h4 number="4.2.2.3"><span class="header-section-number">4.2.2.3</span> Read in SNP density data</h4>
<div id="hni-and-hsok" class="section level5" number="4.2.2.3.1">
<h5 number="4.2.2.3.1"><span class="header-section-number">4.2.2.3.1</span> HNI and HSOK</h5>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> <span class="st">&quot;/nfs/research/birney/users/ian/mikk_genome/introgression/hni_hsok.txt.gz&quot;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in file on local</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ol_ranges_df <span class="ot">=</span> <span class="fu">read.table</span>(in_file,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">header =</span> T, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">as.is =</span> T)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>ol_ranges_df_long <span class="ot">=</span> ol_ranges_df <span class="sc">%&gt;%</span> </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(hni, hsok), <span class="at">names_to =</span> <span class="st">&quot;line&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;present&quot;</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>ol_ranges_list <span class="ot">=</span> <span class="fu">split</span>(ol_ranges_df_long, <span class="at">f =</span> ol_ranges_df_long<span class="sc">$</span>line)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>ol_ranges_list <span class="ot">=</span> <span class="fu">lapply</span>(ol_ranges_list, <span class="cf">function</span>(x){</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove NAs</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">=</span> x <span class="sc">%&gt;%</span> </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">drop_na</span>(present)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert to GRanges object</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  ol_ranges <span class="ot">=</span> GenomicRanges<span class="sc">::</span><span class="fu">makeGRangesFromDataFrame</span>(df,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">ignore.strand =</span> T,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">seqnames.field =</span> <span class="st">&quot;chr&quot;</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">start.field =</span> <span class="st">&quot;pos&quot;</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">end.field =</span> <span class="st">&quot;pos&quot;</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ol_ranges)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="mikk" class="section level5" number="4.2.2.3.2">
<h5 number="4.2.2.3.2"><span class="header-section-number">4.2.2.3.2</span> MIKK</h5>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/introgression/mikk.txt.gz&quot;</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in file on local</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>mikk_ranges_df <span class="ot">=</span> <span class="fu">read.table</span>(in_file,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;pos&quot;</span>), </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">as.is =</span> T)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to GRanges object</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>mikk_ranges <span class="ot">=</span> GenomicRanges<span class="sc">::</span><span class="fu">makeGRangesFromDataFrame</span>(mikk_ranges_df,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">ignore.strand =</span> T,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">seqnames.field =</span> <span class="st">&quot;chr&quot;</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">start.field =</span> <span class="st">&quot;pos&quot;</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">end.field =</span> <span class="st">&quot;pos&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="get-exon-density" class="section level4" number="4.2.2.4">
<h4 number="4.2.2.4"><span class="header-section-number">4.2.2.4</span> Get exon density</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of exons from biomaRt</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Select dataset</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>olat_mart <span class="ot">=</span> biomaRt<span class="sc">::</span><span class="fu">useEnsembl</span>(<span class="at">biomart =</span> <span class="st">&quot;ensembl&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;olatipes_gene_ensembl&quot;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Get attributes of interest (exon ID, chr, start, end)</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>exons <span class="ot">&lt;-</span> biomaRt<span class="sc">::</span><span class="fu">getBM</span>(<span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;chromosome_name&quot;</span>, <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;ensembl_transcript_id&quot;</span>, <span class="st">&quot;transcript_start&quot;</span>, <span class="st">&quot;transcript_end&quot;</span>, <span class="st">&quot;transcript_length&quot;</span>, <span class="st">&quot;ensembl_exon_id&quot;</span>, <span class="st">&quot;rank&quot;</span>, <span class="st">&quot;strand&quot;</span>, <span class="st">&quot;exon_chrom_start&quot;</span>, <span class="st">&quot;exon_chrom_end&quot;</span>, <span class="st">&quot;cds_start&quot;</span>, <span class="st">&quot;cds_end&quot;</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">mart =</span> olat_mart)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Convert exons to GRanges</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>ex_ranges <span class="ot">=</span> GenomicRanges<span class="sc">::</span><span class="fu">makeGRangesFromDataFrame</span>(exons,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">ignore.strand =</span> T,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">seqnames.field =</span> <span class="st">&quot;chromosome_name&quot;</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">start.field =</span> <span class="st">&quot;exon_chrom_start&quot;</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                                                    <span class="at">end.field =</span> <span class="st">&quot;exon_chrom_end&quot;</span>)</span></code></pre></div>
</div>
<div id="all-chromosomes" class="section level4" number="4.2.2.5">
<h4 number="4.2.2.5"><span class="header-section-number">4.2.2.5</span> All chromosomes</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>file_out <span class="ot">=</span> <span class="fu">file.path</span>(plots_dir, <span class="st">&quot;20210318_fd_with_density_all.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>file_out,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">8500</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">13500</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>kp <span class="ot">=</span> <span class="fu">plotKaryotype</span>(med_genome)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base numbers </span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpAddBaseNumbers</span>(kp, <span class="at">tick.dist =</span> <span class="dv">5000000</span>, <span class="at">cex =</span> <span class="fl">0.3</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add data backgrounds</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpDataBackground</span>(kp, <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis label</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAxis</span>(kp, <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.4</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add fd data</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F3B61F&quot;</span>,</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>,</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SNP density data</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>mikk_ranges, <span class="at">col =</span> <span class="st">&quot;#49A379&quot;</span>,</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.1</span>, </span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hni, <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.2</span>, </span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hsok, <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>, </span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.3</span>, </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="co">#kpPlotDensity(kp, data=ol_ranges_list$hdrr, col = &quot;#F3B61F&quot;,</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="co">#              r0=0.45, r1=0.6,</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="co">#              window.size = 25000)</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Add exon density to ideogram</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">0</span>)</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;MIKK&quot;</span>,</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.05</span>,</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.4</span>)</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HNI&quot;</span>,</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.15</span>, </span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.4</span>)</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HSOK&quot;</span>,</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.25</span>,</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.4</span>)</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="co">#kpAddLabels(kp, labels=&quot;HdrR&quot;,</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a><span class="co">#            r0=0.45, r1=0.6, </span></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="co">#            cex = 0.4)</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="fu">bquote</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1=</span><span class="dv">1</span>, </span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.035</span>,</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(file_out)</span></code></pre></div>
<p><img src="plots/introgression/20210318_fd_with_density_all.png" width="4250" /></p>
</div>
<div id="chromosome-4" class="section level4" number="4.2.2.6">
<h4 number="4.2.2.6"><span class="header-section-number">4.2.2.6</span> Chromosome 4</h4>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> <span class="fu">file.path</span>(plots_dir, <span class="st">&quot;20210318_fd_with_density_chr_4.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>out_file,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">5500</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">1186</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>kp <span class="ot">=</span> <span class="fu">plotKaryotype</span>(med_genome, <span class="at">chromosomes =</span> <span class="st">&quot;4&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base numbers </span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpAddBaseNumbers</span>(kp, <span class="at">tick.dist =</span> <span class="dv">5000000</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add data backgrounds</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpDataBackground</span>(kp, <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis label</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAxis</span>(kp, <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add fd data</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>lwd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F3B61F&quot;</span>,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SNP density data</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>mikk_ranges, <span class="at">col =</span> <span class="st">&quot;#49A379&quot;</span>,</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.1</span>, </span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hni, <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.2</span>, </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hsok, <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>, </span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.3</span>, </span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="co">#kpPlotDensity(kp, data=ol_ranges_list$hdrr, col = &quot;#F3B61F&quot;,</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a><span class="co">#              r0=0.45, r1=0.6,</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a><span class="co">#              window.size = 25000)</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Add exon density to ideogram</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">0</span>)</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;MIKK&quot;</span>,</span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.05</span>,</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HNI&quot;</span>,</span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.15</span>, </span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HSOK&quot;</span>,</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.25</span>,</span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a><span class="co">#kpAddLabels(kp, labels=&quot;HdrR&quot;,</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a><span class="co">#            r0=0.45, r1=0.6, </span></span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="co">#            cex = 0.4)</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="fu">bquote</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1=</span><span class="dv">1</span>, </span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.035</span>,</span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_file)</span></code></pre></div>
<p><img src="plots/introgression/20210318_fd_with_density_chr_4.png" width="2750" /></p>
</div>
</div>
</div>
</div>
<div id="final-figure" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Final figure</h1>
<div id="abba-baba-diagram" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> ABBA BABA diagram</h2>
<p>Created with <a href="https://vectr.com/">Vectr</a> and saved here: <code>plots/introgression/20210318_abba_diagram.svg</code></p>
</div>
<div id="compile-all" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Compile all</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>abba_diagram <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;abba_diagram.png&quot;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_with_ancestor.png&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>karyo_chr4 <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210318_fd_with_density_chr_4.png&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>final_abba <span class="ot">=</span> <span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(tree,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">7</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">35</span>, <span class="at">vjust =</span> .<span class="dv">1</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(karyo_chr4,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fl">0.3</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span>   </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot</span>(fstat_plot,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> .<span class="dv">4</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">width =</span> .<span class="dv">6</span>, <span class="at">height =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(abba_diagram,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">35</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">05</span>, <span class="at">scale =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot_label</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">size =</span> <span class="dv">16</span>,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">38</span>, <span class="dv">0</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">7</span>, <span class="dv">1</span>, .<span class="dv">3</span>))  </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>final_abba</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-48-1.svg" width="1344" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210318_final_figure.png&quot;</span>),</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">35</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">21.875</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">500</span>)</span></code></pre></div>
</div>
</div>
<div id="new-final-figure-with-circos" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> New final figure with circos</h1>
<div id="circos" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Circos</h2>
<div id="read-in-data-2" class="section level3" number="6.1.1">
<h3 number="6.1.1"><span class="header-section-number">6.1.1</span> Read in data</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>target_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/introgression/abba_sliding_final_with_icab/min-sites-250.txt&quot;</span>)</span></code></pre></div>
<p>Sanity check with counts of sites:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(target_file) <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sliding window length</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">window_length_kb =</span> (end <span class="sc">-</span> start <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for 500 kb windows</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(window_length_kb <span class="sc">==</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(p1, p2)</span></code></pre></div>
<pre><code>## Rows: 12862 Columns: 13</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): p1, p2
## dbl (11): scaffold, start, end, mid, sites, sitesUsed, ABBA, BABA, D, fd, fdM</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 6 × 3
##   p1    p2        n
##   &lt;chr&gt; &lt;chr&gt; &lt;int&gt;
## 1 hdrr  hni    1395
## 2 hdrr  hsok   1408
## 3 hdrr  icab   1440
## 4 icab  hdrr   1440
## 5 icab  hni    1396
## 6 icab  hsok   1408</code></pre>
<p>As suggested by Simon Martin here: <a href="https://github.com/simonhmartin/genomics_general#abba-baba-statistics-in-sliding-windows" class="uri">https://github.com/simonhmartin/genomics_general#abba-baba-statistics-in-sliding-windows</a> &gt; fd gives meaningless values (&lt;0 or &gt;1) if D is negative. If there is no excess of shared derived alleles between P2 and P3 (indicated by a positive D), then the excess cannot be quantified. fd values for windows with negative D should therefore either be discarded or converted to zero, depending on your hypothesis.</p>
<div id="how-many-windows-have-d-0" class="section level4" number="6.1.1.1">
<h4 number="6.1.1.1"><span class="header-section-number">6.1.1.1</span> How many windows have D &gt; 0?</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(target_file) <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sliding window length</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">window_length_kb =</span> (end <span class="sc">-</span> start <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for 500 kb windows</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(window_length_kb <span class="sc">==</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recode lines</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">factor</span>(.x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;icab&quot;</span>, <span class="st">&quot;hdrr&quot;</span>, <span class="st">&quot;hni&quot;</span>, <span class="st">&quot;hsok&quot;</span>))),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">recode</span>(.x, <span class="at">icab =</span> <span class="st">&quot;iCab&quot;</span>, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(p1, p2) <span class="sc">%&gt;%</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n_pos_d =</span> <span class="fu">length</span>(<span class="fu">which</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(p2, n_pos_d, <span class="at">fill =</span> p2)) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>p1) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_abba) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;P2&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of windows (sites) with positive D&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Choice of P1 (iCab or HdrR)&quot;</span>) <span class="sc">+</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;P2&quot;</span>)</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-52-1.svg" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;docs/plots/introgression/20210429_p1_hdrr_v_icab_counts_valid_sites.png&quot;</span>),</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width=</span><span class="fl">15.69</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">height=</span><span class="dv">10</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">400</span>)</span></code></pre></div>
</div>
<div id="distributions-of-f_d" class="section level4" number="6.1.1.2">
<h4 number="6.1.1.2"><span class="header-section-number">6.1.1.2</span> Distributions of <span class="math inline">\(f_D\)</span></h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(target_file) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sliding window length</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">window_length_kb =</span> (end <span class="sc">-</span> start <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for 500 kb windows</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(window_length_kb <span class="sc">==</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recode lines</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">factor</span>(.x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;icab&quot;</span>, <span class="st">&quot;hdrr&quot;</span>, <span class="st">&quot;hni&quot;</span>, <span class="st">&quot;hsok&quot;</span>))),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">recode</span>(.x, <span class="at">icab =</span> <span class="st">&quot;iCab&quot;</span>, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove all rows where D &lt; 0</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(fd, <span class="at">fill =</span> p2), <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(p1, p2)) <span class="sc">+</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal_abba) <span class="sc">+</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;P2&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">#    ylab(&quot;Number of windows (sites) with positive D&quot;) +</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(f[d]))) <span class="sc">+</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_cowplot</span>()  </span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-54-1.svg" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;docs/plots/introgression/20210429_p1_hdrr_v_icab_fd_distribution.png&quot;</span>),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> <span class="st">&quot;png&quot;</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width=</span><span class="fl">15.69</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">height=</span><span class="dv">10</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">400</span>)</span></code></pre></div>
</div>
<div id="get-mean-fd-for-each-population" class="section level4" number="6.1.1.3">
<h4 number="6.1.1.3"><span class="header-section-number">6.1.1.3</span> Get mean fd for each population</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">read_csv</span>(target_file) <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sliding window length</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">window_length_kb =</span> (end <span class="sc">-</span> start <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for 500 kb windows</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(window_length_kb <span class="sc">==</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recode lines</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">factor</span>(.x, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;icab&quot;</span>, <span class="st">&quot;hdrr&quot;</span>, <span class="st">&quot;hni&quot;</span>, <span class="st">&quot;hsok&quot;</span>))),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="sc">~</span><span class="fu">recode</span>(.x, <span class="at">icab =</span> <span class="st">&quot;iCab&quot;</span>, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove all rows where D &lt; 0</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p1 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(p2) <span class="sc">%&gt;%</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">mean</span>(fd))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   p2    `mean(fd)`
##   &lt;fct&gt;      &lt;dbl&gt;
## 1 iCab      0.254 
## 2 HNI       0.0938
## 3 HSOK      0.120</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mikk_abba_final <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(target_file) <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sliding window length</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">window_length_kb =</span> (end <span class="sc">-</span> start <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter for 500 kb windows</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(window_length_kb <span class="sc">==</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recode `fd` as 0 if `D` is negative</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fd =</span> <span class="fu">ifelse</span>(D <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, fd))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Is iCab or HdrR closer to MIKK?</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>mikk_abba_final <span class="sc">%&gt;%</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;icab&quot;</span>, <span class="st">&quot;hdrr&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(p1, p2) <span class="sc">%&gt;%</span> </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">length</span>(<span class="fu">which</span>(fd <span class="sc">==</span> <span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
## # Groups:   p1 [2]
##   p1    p2    `length(which(fd == 0))`
##   &lt;chr&gt; &lt;chr&gt;                    &lt;int&gt;
## 1 hdrr  icab                       598
## 2 icab  hdrr                       958</code></pre>
<p>There are fewer 0s when HdrR is P1, which suggests that iCab is more closely related to the MIKK panel. But you want a P1 that is further away so that you’ll get more data points, which is why we’ll likely go with HdrR.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mikk_abba_final <span class="ot">=</span> mikk_abba_final <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recode lines</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p2 =</span> <span class="fu">factor</span>(p2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;hdrr&quot;</span>, <span class="st">&quot;icab&quot;</span>, <span class="st">&quot;hni&quot;</span>, <span class="st">&quot;hsok&quot;</span>)),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">p2 =</span> <span class="fu">recode</span>(p2, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">icab =</span> <span class="st">&quot;iCab&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p2, scaffold, start) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(scaffold, <span class="at">mid_1 =</span> mid, <span class="at">mid_2 =</span> mid, fd, p1, p2) <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">scaffold =</span> <span class="fu">paste</span>(<span class="st">&quot;chr&quot;</span>, scaffold, <span class="at">sep =</span><span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(., <span class="at">f =</span> .<span class="sc">$</span>p1) <span class="sc">%&gt;%</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(., <span class="cf">function</span>(P1) <span class="fu">split</span>(P1, <span class="at">f =</span> P1<span class="sc">$</span>p2)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove empty data frames for hdrr-hdrr and icab-icab population combinations</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(., <span class="cf">function</span>(P1) P1[purrr<span class="sc">::</span><span class="fu">map_lgl</span>(P1, <span class="cf">function</span>(P2) <span class="fu">nrow</span>(P2) <span class="sc">!=</span> <span class="dv">0</span>)])</span></code></pre></div>
</div>
</div>
<div id="plot-2" class="section level3" number="6.1.2">
<h3 number="6.1.2"><span class="header-section-number">6.1.2</span> Plot</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>out_plot <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;docs/plots/introgression/20210427_introgression_circos_MIKK_ABBA_p1-hdrr.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>target_list <span class="ot">=</span> mikk_abba_final[[<span class="st">&quot;hdrr&quot;</span>]]</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(out_plot,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">20</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">500</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Decrease cell padding from default c(0.02, 1.00, 0.02, 1.00)</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">gap.degree =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(chroms) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">6</span>))</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize plot</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initializeWithIdeogram</span>(chroms,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotType =</span> <span class="fu">c</span>(<span class="st">&quot;axis&quot;</span>, <span class="st">&quot;labels&quot;</span>),</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">major.by =</span> <span class="fl">1e7</span>,</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">axis.labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print label in center</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&quot;MIKK panel</span><span class="sc">\n</span><span class="st">introgression with</span><span class="sc">\n</span><span class="st">iCab, HNI,</span><span class="sc">\n</span><span class="st">and</span><span class="sc">\n</span><span class="st">HSOK&quot;</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Introgression</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(target_list, <span class="cf">function</span>(P2){</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set counter</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.genomicTrack</span>(P2,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.fun =</span> <span class="cf">function</span>(region, value, ...){</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.genomicLines</span>(region,</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>                            value[[<span class="dv">1</span>]],</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col =</span> pal_abba[[<span class="fu">names</span>(target_list[counter])]],</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">area =</span> T,</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">border =</span> karyoploteR<span class="sc">::</span><span class="fu">darker</span>(pal_abba[[<span class="fu">names</span>(target_list[counter])]],</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">amount =</span> <span class="dv">80</span>))</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add baseline</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.xaxis</span>(<span class="at">h =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> F,</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">major.tick =</span> F)</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">track.height =</span> <span class="fl">0.1</span>,</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">bg.border =</span> <span class="cn">NA</span>,</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add axis for introgression</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.yaxis</span>(<span class="at">side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">at =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>),</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">tick.length =</span> <span class="dv">2</span></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (counter <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true" tabindex="-1"></a><span class="co">#              facing = &quot;clockwise&quot;,</span></span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">names</span>(target_list)[counter],</span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>,</span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))  </span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_plot)</span></code></pre></div>
<p><img src="plots/introgression/20210427_introgression_circos_MIKK_ABBA_p1-hdrr.png" width="1968" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>out_plot <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;docs/plots/introgression/20210427_introgression_circos_MIKK_ABBA_p1-icab.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>target_list <span class="ot">=</span> mikk_abba_final[[<span class="st">&quot;icab&quot;</span>]]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(out_plot,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">20</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">500</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Decrease cell padding from default c(0.02, 1.00, 0.02, 1.00)</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">gap.degree =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(chroms) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">6</span>))</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize plot</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initializeWithIdeogram</span>(chroms,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotType =</span> <span class="fu">c</span>(<span class="st">&quot;axis&quot;</span>, <span class="st">&quot;labels&quot;</span>),</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">major.by =</span> <span class="fl">1e7</span>,</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">axis.labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print label in center</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&quot;MIKK panel</span><span class="sc">\n</span><span class="st">introgression with</span><span class="sc">\n</span><span class="st">HdrR, HNI,</span><span class="sc">\n</span><span class="st">and</span><span class="sc">\n</span><span class="st">HSOK&quot;</span>)</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Introgression</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(target_list, <span class="cf">function</span>(P2){</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set counter</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.genomicTrack</span>(P2,</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.fun =</span> <span class="cf">function</span>(region, value, ...){</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.genomicLines</span>(region,</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>                            value[[<span class="dv">1</span>]],</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col =</span> pal_abba[[<span class="fu">names</span>(target_list[counter])]],</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">area =</span> T,</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">border =</span> karyoploteR<span class="sc">::</span><span class="fu">darker</span>(pal_abba[[<span class="fu">names</span>(target_list[counter])]]))</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add baseline</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.xaxis</span>(<span class="at">h =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> F,</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>                     <span class="at">major.tick =</span> F)</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">track.height =</span> <span class="fl">0.1</span>,</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">bg.border =</span> <span class="cn">NA</span>,</span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add axis for introgression</span></span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.yaxis</span>(<span class="at">side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">at =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>),</span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">tick.length =</span> <span class="dv">2</span></span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (counter <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a><span class="co">#              facing = &quot;clockwise&quot;,</span></span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">names</span>(target_list)[counter],</span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>              <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>,</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))  </span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_plot)</span></code></pre></div>
<p><img src="plots/introgression/20210427_introgression_circos_MIKK_ABBA_p1-icab.png" width="1968" /> ### Final for paper (with iCab as yellow)</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>out_plot <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;docs/plots/introgression/20210505_introgression_circos_MIKK_ABBA_p1-hdrr.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>target_list <span class="ot">=</span> mikk_abba_final[[<span class="st">&quot;hdrr&quot;</span>]]</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset palette</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>pal_abba <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#F3B61F&quot;</span>, <span class="st">&quot;#F3B61F&quot;</span>, <span class="st">&quot;#631E68&quot;</span>, <span class="st">&quot;#F6673A&quot;</span>, <span class="st">&quot;#F33A56&quot;</span>, <span class="st">&quot;#55B6B0&quot;</span>, <span class="st">&quot;#621B00&quot;</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pal_abba) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;iCab&quot;</span>, <span class="st">&quot;HdrR&quot;</span>, <span class="st">&quot;HSOK&quot;</span>, <span class="st">&quot;HNI&quot;</span>, <span class="st">&quot;melastigma&quot;</span>, <span class="st">&quot;javanicus&quot;</span>, <span class="st">&quot;Kaga&quot;</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(out_plot,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">20</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">20</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">500</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Decrease cell padding from default c(0.02, 1.00, 0.02, 1.00)</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.par</span>(<span class="at">cell.padding =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">track.margin =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">gap.degree =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(chroms) <span class="sc">-</span> <span class="dv">1</span>), <span class="dv">6</span>))</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize plot</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.initializeWithIdeogram</span>(chroms,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotType =</span> <span class="fu">c</span>(<span class="st">&quot;axis&quot;</span>, <span class="st">&quot;labels&quot;</span>),</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">major.by =</span> <span class="fl">1e7</span>,</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>                              <span class="at">axis.labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Print label in center</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&quot;MIKK panel</span><span class="sc">\n</span><span class="st">introgression with</span><span class="sc">\n</span><span class="st">iCab, HNI,</span><span class="sc">\n</span><span class="st">and</span><span class="sc">\n</span><span class="st">HSOK&quot;</span>)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Introgression</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>counter <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(target_list, <span class="cf">function</span>(P2){</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set counter</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  counter <span class="ot">&lt;&lt;-</span> counter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.genomicTrack</span>(P2,</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.fun =</span> <span class="cf">function</span>(region, value, ...){</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.genomicLines</span>(region,</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>                            value[[<span class="dv">1</span>]],</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col =</span> pal_abba[[<span class="fu">names</span>(target_list[counter])]],</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">area =</span> T,</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>                            <span class="at">border =</span> karyoploteR<span class="sc">::</span><span class="fu">darker</span>(pal_abba[[<span class="fu">names</span>(target_list[counter])]],</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">amount =</span> <span class="dv">80</span>))</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add baseline</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">circos.xaxis</span>(<span class="at">h =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> F,</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>                     <span class="at">major.tick =</span> F)</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>      },</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">track.height =</span> <span class="fl">0.1</span>,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">bg.border =</span> <span class="cn">NA</span>,</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add axis for introgression</span></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.yaxis</span>(<span class="at">side =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">at =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">labels.cex =</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>),</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">tick.length =</span> <span class="dv">2</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (counter <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a><span class="co">#              facing = &quot;clockwise&quot;,</span></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">0.5</span>),</span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))</span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add y-axis label for introgression</span></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circos.text</span>(<span class="dv">0</span>, <span class="fl">0.5</span>,</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">names</span>(target_list)[counter],</span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">sector.index =</span> <span class="st">&quot;chr1&quot;</span>,</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>              <span class="at">facing =</span> <span class="st">&quot;clockwise&quot;</span>,</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>              <span class="at">adj =</span> <span class="fu">c</span>(.<span class="dv">5</span>, <span class="dv">0</span>),</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>              <span class="at">cex =</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">par</span>(<span class="st">&quot;cex&quot;</span>))  </span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a><span class="fu">circos.clear</span>()</span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_plot)</span></code></pre></div>
<p><img src="plots/introgression/20210505_introgression_circos_MIKK_ABBA_p1-hdrr.png" width="1968" /></p>
</div>
</div>
<div id="re-do-final-figure-just-tree-schema-and-circos" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Re-do final figure (just tree, schema, and circos)</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>abba_diagram <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210505_abba_diagram.png&quot;</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_latipes_with_ancestor.png&quot;</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>circos_abba <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210505_introgression_circos_MIKK_ABBA_p1-hdrr.png&quot;</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>final_abba <span class="ot">=</span> <span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(tree,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">55</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span>    </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(circos_abba,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> .<span class="dv">4</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">width =</span> .<span class="dv">6</span>, <span class="at">height =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(abba_diagram,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">55</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">125</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot_label</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="at">size =</span> <span class="dv">25</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">4</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">6</span>, <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;#4f0943&quot;</span>)  </span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>final_abba</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-68-1.svg" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210505_introgression_final_figure.png&quot;</span>),</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">35</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">21.875</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">500</span>)</span></code></pre></div>
</div>
<div id="re-do-final-figure" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Re-do final figure</h2>
<div id="chr2" class="section level3" number="6.3.1">
<h3 number="6.3.1"><span class="header-section-number">6.3.1</span> Chr2</h3>
<div id="read-in-new-data" class="section level4" number="6.3.1.1">
<h4 number="6.3.1.1"><span class="header-section-number">6.3.1.1</span> Read in new data</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>in_file <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/introgression/abba_sliding_final_no_131-1&quot;</span>, <span class="st">&quot;500000_250.txt&quot;</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(in_file) <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p1, p2, scaffold, start)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert fd to 0 if D &lt; 0</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fd <span class="ot">=</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>D <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>               df<span class="sc">$</span>fd)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change names</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p2 =</span> <span class="fu">recode</span>(df<span class="sc">$</span>p2, <span class="at">hdrr =</span> <span class="st">&quot;HdrR&quot;</span>, <span class="at">hni =</span> <span class="st">&quot;HNI&quot;</span>, <span class="at">hsok =</span> <span class="st">&quot;HSOK&quot;</span>))</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get df with mean of melastigma/javanicus</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>df_kp <span class="ot">=</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(scaffold, start, end, mid, p2), <span class="at">names_from =</span> p1, <span class="at">values_from =</span> fd) <span class="sc">%&gt;%</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get mean of melastigma/javanicus</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mean_fd =</span> <span class="fu">rowMeans</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., melastigma, javanicus), <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(p2, scaffold, start)</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(df_kp))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">scaffold</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="right">mid</th>
<th align="left">p2</th>
<th align="right">javanicus</th>
<th align="right">melastigma</th>
<th align="right">mean_fd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">500001</td>
<td align="right">1000000</td>
<td align="right">770583</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.1788</td>
<td align="right">0.17880</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1000001</td>
<td align="right">1500000</td>
<td align="right">1227968</td>
<td align="left">HdrR</td>
<td align="right">0.4058</td>
<td align="right">0.2320</td>
<td align="right">0.31890</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1500001</td>
<td align="right">2000000</td>
<td align="right">1764457</td>
<td align="left">HdrR</td>
<td align="right">0.3459</td>
<td align="right">0.2768</td>
<td align="right">0.31135</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2000001</td>
<td align="right">2500000</td>
<td align="right">2205406</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.3024</td>
<td align="right">0.30240</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2500001</td>
<td align="right">3000000</td>
<td align="right">2776011</td>
<td align="left">HdrR</td>
<td align="right">NA</td>
<td align="right">0.3551</td>
<td align="right">0.35510</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3000001</td>
<td align="right">3500000</td>
<td align="right">3243647</td>
<td align="left">HdrR</td>
<td align="right">0.3074</td>
<td align="right">0.2239</td>
<td align="right">0.26565</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-3" class="section level4" number="6.3.1.2">
<h4 number="6.3.1.2"><span class="header-section-number">6.3.1.2</span> Plot</h4>
<div id="chr4" class="section level5" number="6.3.1.2.1">
<h5 number="6.3.1.2.1"><span class="header-section-number">6.3.1.2.1</span> chr4</h5>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> <span class="fu">file.path</span>(plots_dir, <span class="st">&quot;20210409_fd_with_density_chr_4_500kb-window.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>out_file,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">5500</span>,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">1186</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>kp <span class="ot">=</span> <span class="fu">plotKaryotype</span>(med_genome, <span class="at">chromosomes =</span> <span class="st">&quot;4&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base numbers </span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpAddBaseNumbers</span>(kp, <span class="at">tick.dist =</span> <span class="dv">5000000</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add data backgrounds</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpDataBackground</span>(kp, <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis label</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAxis</span>(kp, <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add fd data</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>lwd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F3B61F&quot;</span>,</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>,</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SNP density data</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>mikk_ranges, <span class="at">col =</span> <span class="st">&quot;#49A379&quot;</span>,</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.1</span>, </span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hni, <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.2</span>, </span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hsok, <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>, </span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.3</span>, </span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a><span class="co">#kpPlotDensity(kp, data=ol_ranges_list$hdrr, col = &quot;#F3B61F&quot;,</span></span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a><span class="co">#              r0=0.45, r1=0.6,</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a><span class="co">#              window.size = 25000)</span></span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Add exon density to ideogram</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">0</span>)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;MIKK&quot;</span>,</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.05</span>,</span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HNI&quot;</span>,</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.15</span>, </span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HSOK&quot;</span>,</span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.25</span>,</span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="fu">bquote</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1=</span><span class="dv">1</span>, </span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.035</span>,</span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_file)</span></code></pre></div>
<p><img src="plots/introgression/20210409_fd_with_density_chr_4_500kb-window.png" width="2750" /> ##### chr2</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>out_file <span class="ot">=</span> <span class="fu">file.path</span>(plots_dir, <span class="st">&quot;20210409_fd_with_density_chr_2_500kb-window.png&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file=</span>out_file,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">width=</span><span class="dv">5500</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">height=</span><span class="dv">1186</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">units =</span> <span class="st">&quot;px&quot;</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">res =</span> <span class="dv">400</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>kp <span class="ot">=</span> <span class="fu">plotKaryotype</span>(med_genome, <span class="at">chromosomes =</span> <span class="st">&quot;2&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add base numbers </span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpAddBaseNumbers</span>(kp, <span class="at">tick.dist =</span> <span class="dv">5000000</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add data backgrounds</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpDataBackground</span>(kp, <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add axis label</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAxis</span>(kp, <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add fd data</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>lwd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HNI&quot;</span>],</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HdrR&quot;</span>],</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#F3B61F&quot;</span>,</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>karyoploteR<span class="sc">::</span><span class="fu">kpLines</span>(kp,</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chr =</span> df_kp<span class="sc">$</span>scaffold[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> df_kp<span class="sc">$</span>mid[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> df_kp<span class="sc">$</span>mean_fd[df_kp<span class="sc">$</span>p2 <span class="sc">==</span> <span class="st">&quot;HSOK&quot;</span>],</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>,</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1 =</span> <span class="dv">1</span>,</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> lwd)</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add SNP density data</span></span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>mikk_ranges, <span class="at">col =</span> <span class="st">&quot;#49A379&quot;</span>,</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.1</span>, </span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hni, <span class="at">col =</span> <span class="st">&quot;#F6673A&quot;</span>,</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.2</span>, </span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ol_ranges_list<span class="sc">$</span>hsok, <span class="at">col =</span> <span class="st">&quot;#631E68&quot;</span>, </span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.3</span>, </span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>)</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a><span class="co">#kpPlotDensity(kp, data=ol_ranges_list$hdrr, col = &quot;#F3B61F&quot;,</span></span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a><span class="co">#              r0=0.45, r1=0.6,</span></span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a><span class="co">#              window.size = 25000)</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Add exon density to ideogram</span></span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">1</span>)</span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a><span class="fu">kpPlotDensity</span>(kp, <span class="at">data=</span>ex_ranges, <span class="at">col =</span> <span class="st">&quot;#f77cb5&quot;</span>,</span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">data.panel =</span> <span class="st">&quot;ideogram&quot;</span>,</span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">window.size =</span> <span class="dv">25000</span>,</span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">r0 =</span> <span class="fl">0.5</span>, <span class="at">r1 =</span> <span class="dv">0</span>)</span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;MIKK&quot;</span>,</span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="dv">0</span>, <span class="at">r1=</span><span class="fl">0.05</span>,</span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HNI&quot;</span>,</span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.1</span>, <span class="at">r1=</span><span class="fl">0.15</span>, </span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="st">&quot;HSOK&quot;</span>,</span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.2</span>, <span class="at">r1=</span><span class="fl">0.25</span>,</span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.001</span>,</span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a><span class="fu">kpAddLabels</span>(kp, <span class="at">labels=</span><span class="fu">bquote</span>(<span class="fu">italic</span>(f[d])),</span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">r0=</span><span class="fl">0.3</span>, <span class="at">r1=</span><span class="dv">1</span>, </span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.margin =</span> <span class="fl">0.035</span>,</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(out_file)</span></code></pre></div>
<p><img src="plots/introgression/20210409_fd_with_density_chr_2_500kb-window.png" width="2750" /> Use chr4.</p>
</div>
</div>
</div>
<div id="compose-final-figure" class="section level3" number="6.3.2">
<h3 number="6.3.2"><span class="header-section-number">6.3.2</span> Compose final figure</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>abba_diagram <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;abba_diagram.png&quot;</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;tree_oryzias_with_ancestor.png&quot;</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>karyo_chr4 <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210409_fd_with_density_chr_4_500kb-window.png&quot;</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>circos_abba <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210409_introgression_circos_MIKK_ABBA.png&quot;</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>final_abba <span class="ot">=</span> <span class="fu">ggdraw</span>() <span class="sc">+</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(tree,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">7</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">35</span>, <span class="at">vjust =</span> .<span class="dv">1</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">1</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(karyo_chr4,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fl">0.3</span>, <span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(circos_abba,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> .<span class="dv">4</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">width =</span> .<span class="dv">6</span>, <span class="at">height =</span> .<span class="dv">7</span>, <span class="at">scale =</span> <span class="fl">1.15</span>, <span class="at">vjust =</span> .<span class="dv">025</span>) <span class="sc">+</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_image</span>(abba_diagram,</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">3</span>, <span class="at">width =</span> .<span class="dv">4</span>, <span class="at">height =</span> .<span class="dv">35</span>, <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">05</span>, <span class="at">scale =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_plot_label</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">size =</span> <span class="dv">25</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">45</span>, <span class="dv">0</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">7</span>, <span class="dv">1</span>, .<span class="dv">3</span>), <span class="at">color =</span> <span class="st">&quot;#4f0943&quot;</span>)  </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>final_abba</span></code></pre></div>
<p><img src="04_Introgression_files/figure-html/unnamed-chunk-77-1.svg" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(here<span class="sc">::</span><span class="fu">here</span>(plots_dir, <span class="st">&quot;20210409_introgression_final_figure.png&quot;</span>),</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>       final_abba,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">35</span>,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">21.875</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">500</span>)</span></code></pre></div>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
